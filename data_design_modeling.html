<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Design and Modeling</title>
    <link rel="stylesheet" href="/styles/main.css">
    <link rel="icon" href="/favicon.png">
    <script type="module">
      import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
      mermaid.initialize({ startOnLoad: true });
    </script>
</head>
<body>
    <h1>Data Design and Modeling</h1>
    
    <p>If software architecture is the skeleton of your system, then data design is its lifeblood. Just as a doctor needs to understand how blood flows through the body, developers need to understand how data flows through their applications.</p>
    
    <h2>The Library Catalog Metaphor</h2>
    
    <p>Think of your database like a well-organized library. Books (data) are arranged in sections (tables), with catalog cards (indexes) helping you find what you need quickly. Without proper organization, you'd spend hours searching for a single book!</p>
    
    <canvas id="libraryCanvas" width="600" height="300"></canvas>
    
    <script>
    const libraryCanvas = document.getElementById('libraryCanvas');
    const lctx = libraryCanvas.getContext('2d');
    
    // Background
    lctx.fillStyle = '#faf8f5';
    lctx.fillRect(0, 0, 600, 300);
    
    // Bookshelf sections (tables)
    const sections = [
        {x: 50, y: 50, w: 100, h: 200, color: '#8B4513', label: 'Users'},
        {x: 170, y: 50, w: 100, h: 200, color: '#A0522D', label: 'Orders'},
        {x: 290, y: 50, w: 100, h: 200, color: '#D2691E', label: 'Products'},
        {x: 410, y: 50, w: 100, h: 200, color: '#CD853F', label: 'Reviews'}
    ];
    
    sections.forEach(section => {
        // Shelf
        lctx.fillStyle = section.color;
        lctx.fillRect(section.x, section.y, section.w, section.h);
        
        // Books (rows)
        lctx.fillStyle = '#fff';
        for(let i = 0; i < 4; i++) {
            lctx.fillRect(section.x + 10, section.y + 10 + i * 45, 80, 35);
        }
        
        // Label
        lctx.fillStyle = '#333';
        lctx.font = '12px Arial';
        lctx.fillText(section.label, section.x + 25, section.y + 220);
    });
    
    // Catalog (indexes)
    lctx.fillStyle = '#4CAF50';
    lctx.fillRect(520, 100, 60, 80);
    lctx.fillStyle = '#fff';
    lctx.font = '10px Arial';
    lctx.fillText('Index', 535, 120);
    lctx.fillText('Cards', 535, 135);
    
    // Arrows showing quick lookup
    lctx.strokeStyle = '#4CAF50';
    lctx.lineWidth = 2;
    lctx.setLineDash([5, 5]);
    lctx.beginPath();
    lctx.moveTo(520, 140);
    lctx.lineTo(450, 140);
    lctx.lineTo(450, 150);
    lctx.lineTo(350, 150);
    lctx.stroke();
    
    lctx.setLineDash([]);
    lctx.fillStyle = '#333';
    lctx.font = '14px Arial';
    lctx.fillText('Organized data = Fast retrieval', 200, 280);
    </script>
    
    <h2>Entity Relationship Diagrams: The Family Tree of Data</h2>
    
    <p>ER diagrams show how your data entities relate to each other, like a family tree shows relationships between people. Let's build one for a social media platform:</p>
    
    <div class="mermaid">
    erDiagram
        USER ||--o{ POST : creates
        USER ||--o{ COMMENT : writes
        USER ||--o{ FRIEND_REQUEST : sends
        USER ||--o{ FRIEND_REQUEST : receives
        POST ||--o{ COMMENT : has
        POST ||--o{ LIKE : receives
        USER ||--o{ LIKE : gives
        
        USER {
            int user_id PK
            string username UK
            string email UK
            string password_hash
            datetime created_at
            datetime last_login
            boolean is_active
        }
        
        POST {
            int post_id PK
            int user_id FK
            text content
            string image_url
            datetime posted_at
            int like_count
            int comment_count
        }
        
        COMMENT {
            int comment_id PK
            int post_id FK
            int user_id FK
            text content
            datetime commented_at
        }
        
        LIKE {
            int like_id PK
            int user_id FK
            int post_id FK
            datetime liked_at
        }
        
        FRIEND_REQUEST {
            int request_id PK
            int sender_id FK
            int receiver_id FK
            string status
            datetime sent_at
            datetime responded_at
        }
    </div>
    
    <h2>Normalization: The Marie Kondo of Databases</h2>
    
    <p>Just as Marie Kondo teaches us to organize our homes by keeping only what "sparks joy" and avoiding duplication, database normalization teaches us to organize data efficiently:</p>
    
    <canvas id="normalizationCanvas" width="600" height="400"></canvas>
    
    <script>
    const normCanvas = document.getElementById('normalizationCanvas');
    const nctx = normCanvas.getContext('2d');
    
    // Background
    nctx.fillStyle = '#f9f9f9';
    nctx.fillRect(0, 0, 600, 400);
    
    // Before Normalization
    nctx.fillStyle = '#ffcccc';
    nctx.fillRect(20, 50, 260, 150);
    nctx.fillStyle = '#333';
    nctx.font = '14px Arial';
    nctx.fillText('Before: Redundant Data', 80, 30);
    
    // Messy table
    nctx.strokeStyle = '#666';
    nctx.lineWidth = 1;
    nctx.strokeRect(30, 70, 240, 120);
    
    // Headers
    nctx.font = '10px Arial';
    nctx.fillText('Order_ID | Customer | Address | Product | Price', 40, 85);
    
    // Data rows with redundancy
    nctx.fillText('1 | John | 123 Main | Laptop | $999', 40, 105);
    nctx.fillText('2 | John | 123 Main | Mouse | $29', 40, 125);
    nctx.fillText('3 | Jane | 456 Oak | Laptop | $999', 40, 145);
    nctx.fillText('4 | John | 123 Main | Keyboard | $79', 40, 165);
    
    // Highlight redundancy
    nctx.fillStyle = 'rgba(255, 0, 0, 0.2)';
    nctx.fillRect(70, 95, 80, 75);
    
    // After Normalization
    nctx.fillStyle = '#ccffcc';
    nctx.fillRect(320, 50, 260, 300);
    nctx.fillStyle = '#333';
    nctx.font = '14px Arial';
    nctx.fillText('After: Normalized Tables', 380, 30);
    
    // Customers table
    nctx.strokeStyle = '#666';
    nctx.strokeRect(330, 70, 110, 80);
    nctx.font = '11px Arial';
    nctx.fillText('Customers', 360, 65);
    nctx.font = '10px Arial';
    nctx.fillText('ID | Name | Address', 335, 85);
    nctx.fillText('1 | John | 123 Main', 335, 105);
    nctx.fillText('2 | Jane | 456 Oak', 335, 125);
    
    // Products table
    nctx.strokeRect(460, 70, 110, 80);
    nctx.font = '11px Arial';
    nctx.fillText('Products', 495, 65);
    nctx.font = '10px Arial';
    nctx.fillText('ID | Name | Price', 465, 85);
    nctx.fillText('1 | Laptop | $999', 465, 105);
    nctx.fillText('2 | Mouse | $29', 465, 125);
    nctx.fillText('3 | Keyboard | $79', 465, 140);
    
    // Orders table
    nctx.strokeRect(395, 180, 120, 100);
    nctx.font = '11px Arial';
    nctx.fillText('Orders', 440, 175);
    nctx.font = '10px Arial';
    nctx.fillText('ID | Cust_ID | Prod_ID', 400, 195);
    nctx.fillText('1 | 1 | 1', 420, 215);
    nctx.fillText('2 | 1 | 2', 420, 235);
    nctx.fillText('3 | 2 | 1', 420, 255);
    nctx.fillText('4 | 1 | 3', 420, 275);
    
    // Relationship lines
    nctx.strokeStyle = '#4CAF50';
    nctx.lineWidth = 2;
    nctx.beginPath();
    nctx.moveTo(440, 150);
    nctx.lineTo(455, 180);
    nctx.moveTo(515, 150);
    nctx.lineTo(500, 180);
    nctx.stroke();
    
    // Benefits text
    nctx.fillStyle = '#333';
    nctx.font = '12px Arial';
    nctx.fillText('âœ“ No redundancy', 30, 220);
    nctx.fillText('âœ— Updates affect many rows', 30, 240);
    nctx.fillText('âœ— Storage waste', 30, 260);
    
    nctx.fillText('âœ“ Single source of truth', 330, 310);
    nctx.fillText('âœ“ Efficient storage', 330, 330);
    nctx.fillText('âœ“ Easy updates', 330, 350);
    </script>
    
    <h2>Data Flow Diagrams: Following the River</h2>
    
    <p>Data flow diagrams (DFDs) show how information moves through your system, like following a river from its source to the ocean. Let's trace the journey of an online order:</p>
    
    <div class="mermaid">
    graph LR
        subgraph "External Entities"
            Customer[Customer ðŸ‘¤]
            PaymentGW[Payment Gateway ðŸ’³]
            Warehouse[Warehouse ðŸ“¦]
            EmailSvc[Email Service ðŸ“§]
        end
        
        subgraph "Processes"
            P1((1. Place Order))
            P2((2. Validate Payment))
            P3((3. Update Inventory))
            P4((4. Send Confirmation))
        end
        
        subgraph "Data Stores"
            D1[(Order DB)]
            D2[(Product DB)]
            D3[(Customer DB)]
        end
        
        Customer -->|Order Details| P1
        P1 -->|Order Record| D1
        P1 -->|Payment Request| P2
        P2 -->|Payment Info| PaymentGW
        PaymentGW -->|Payment Result| P2
        P2 -->|Update Status| D1
        P2 -->|Trigger| P3
        P3 -->|Check Stock| D2
        P3 -->|Update Quantity| D2
        P3 -->|Fulfillment Request| Warehouse
        P3 -->|Trigger| P4
        P4 -->|Get Customer Info| D3
        P4 -->|Send Email| EmailSvc
        
        style Customer fill:#e3f2fd
        style PaymentGW fill:#e3f2fd
        style Warehouse fill:#e3f2fd
        style EmailSvc fill:#e3f2fd
        style P1 fill:#90caf9
        style P2 fill:#90caf9
        style P3 fill:#90caf9
        style P4 fill:#90caf9
        style D1 fill:#fff9c4
        style D2 fill:#fff9c4
        style D3 fill:#fff9c4
    </div>
    
    <h2>Choosing the Right Database: The Tool for the Job</h2>
    
    <p>Like choosing between a hammer and a screwdriver, different databases serve different purposes:</p>
    
    <canvas id="databaseTypesCanvas" width="600" height="450"></canvas>
    
    <script>
    const dbCanvas = document.getElementById('databaseTypesCanvas');
    const dctx = dbCanvas.getContext('2d');
    
    // Background
    dctx.fillStyle = '#f5f5f5';
    dctx.fillRect(0, 0, 600, 450);
    
    // Title
    dctx.fillStyle = '#333';
    dctx.font = '16px Arial';
    dctx.fillText('Database Types and Use Cases', 200, 30);
    
    // Relational DB
    dctx.fillStyle = '#2196F3';
    dctx.fillRect(50, 60, 120, 150);
    dctx.fillStyle = '#fff';
    dctx.font = '14px Arial';
    dctx.fillText('Relational', 80, 90);
    dctx.font = '11px Arial';
    dctx.fillText('PostgreSQL', 75, 115);
    dctx.fillText('MySQL', 85, 135);
    dctx.fillText('âœ“ ACID', 80, 160);
    dctx.fillText('âœ“ Complex queries', 60, 180);
    dctx.fillText('âœ“ Transactions', 70, 200);
    
    // Document DB
    dctx.fillStyle = '#4CAF50';
    dctx.fillRect(200, 60, 120, 150);
    dctx.fillStyle = '#fff';
    dctx.font = '14px Arial';
    dctx.fillText('Document', 235, 90);
    dctx.font = '11px Arial';
    dctx.fillText('MongoDB', 230, 115);
    dctx.fillText('CouchDB', 230, 135);
    dctx.fillText('âœ“ Flexible schema', 205, 160);
    dctx.fillText('âœ“ JSON data', 220, 180);
    dctx.fillText('âœ“ Scalability', 220, 200);
    
    // Key-Value DB
    dctx.fillStyle = '#FF9800';
    dctx.fillRect(350, 60, 120, 150);
    dctx.fillStyle = '#fff';
    dctx.font = '14px Arial';
    dctx.fillText('Key-Value', 380, 90);
    dctx.font = '11px Arial';
    dctx.fillText('Redis', 395, 115);
    dctx.fillText('DynamoDB', 375, 135);
    dctx.fillText('âœ“ Fast lookups', 365, 160);
    dctx.fillText('âœ“ Caching', 380, 180);
    dctx.fillText('âœ“ Sessions', 380, 200);
    
    // Graph DB
    dctx.fillStyle = '#9C27B0';
    dctx.fillRect(500, 60, 80, 150);
    dctx.fillStyle = '#fff';
    dctx.font = '14px Arial';
    dctx.fillText('Graph', 520, 90);
    dctx.font = '11px Arial';
    dctx.fillText('Neo4j', 520, 115);
    dctx.fillText('âœ“ Relations', 505, 160);
    dctx.fillText('âœ“ Networks', 505, 180);
    dctx.fillText('âœ“ Paths', 515, 200);
    
    // Use case examples
    dctx.fillStyle = '#333';
    dctx.font = '12px Arial';
    dctx.fillText('E-commerce', 75, 235);
    dctx.fillText('Orders', 90, 250);
    
    dctx.fillText('Content CMS', 225, 235);
    dctx.fillText('Blogs', 240, 250);
    
    dctx.fillText('Session Store', 370, 235);
    dctx.fillText('Cache', 395, 250);
    
    dctx.fillText('Social', 515, 235);
    dctx.fillText('Network', 510, 250);
    
    // Decision flowchart
    dctx.strokeStyle = '#666';
    dctx.lineWidth = 2;
    dctx.strokeRect(50, 280, 500, 150);
    
    dctx.fillStyle = '#333';
    dctx.font = '14px Arial';
    dctx.fillText('Quick Decision Guide:', 60, 300);
    
    dctx.font = '12px Arial';
    dctx.fillText('Need ACID compliance? â†’ Relational', 70, 330);
    dctx.fillText('Flexible/nested data? â†’ Document', 70, 355);
    dctx.fillText('Simple key lookups? â†’ Key-Value', 70, 380);
    dctx.fillText('Complex relationships? â†’ Graph', 70, 405);
    </script>
    
    <h2>Data Migration: Moving Day for Your Data</h2>
    
    <p>Data migration is like moving to a new house - you need to plan carefully, pack properly, and make sure nothing gets lost along the way:</p>
    
    <div class="mermaid">
    graph TD
        A[Migration Planning] --> B[Data Analysis]
        B --> C[Schema Mapping]
        C --> D[Test Migration]
        D --> E{Validation OK?}
        E -->|No| C
        E -->|Yes| F[Production Migration]
        F --> G[Post-Migration Validation]
        G --> H[Cleanup & Optimization]
        
        B --> I[Identify data types]
        B --> J[Check constraints]
        B --> K[Document relationships]
        
        C --> L[Field mapping]
        C --> M[Transform rules]
        C --> N[Default values]
        
        style A fill:#e3f2fd
        style E fill:#fff3e0
        style F fill:#ffccbc
        style H fill:#c8e6c9
    </div>
    
    <h2>Best Practices: The Data Commandments</h2>
    
    <div style="background-color: #e8f5e9; padding: 20px; border-radius: 8px; margin: 20px 0;">
        <h3>The Sacred Rules of Data Design</h3>
        
        <p><strong>1. Name Things Clearly:</strong> Use descriptive names. <code>user_email</code> beats <code>ue</code> every time.</p>
        
        <p><strong>2. Be Consistent:</strong> If you use <code>user_id</code> in one table, don't use <code>userId</code> in another.</p>
        
        <p><strong>3. Plan for Growth:</strong> That <code>phone_number</code> field? Make it big enough for international numbers.</p>
        
        <p><strong>4. Index Wisely:</strong> Like bookmarks in a book - useful, but too many slow things down.</p>
        
        <p><strong>5. Document Everything:</strong> Future you (and your teammates) will thank present you.</p>
        
        <p><strong>6. Think About Deletion:</strong> Soft deletes vs hard deletes - choose based on audit needs.</p>
        
        <p><strong>7. Version Your Schema:</strong> Track changes like you track code changes.</p>
    </div>
    
    <h2>Real-World Example: Healthcare System Data Model</h2>
    
    <div class="mermaid">
    erDiagram
        PATIENT ||--o{ APPOINTMENT : schedules
        DOCTOR ||--o{ APPOINTMENT : conducts
        APPOINTMENT ||--|| MEDICAL_RECORD : generates
        PATIENT ||--o{ MEDICAL_RECORD : has
        MEDICAL_RECORD ||--o{ PRESCRIPTION : contains
        DOCTOR ||--o{ PRESCRIPTION : writes
        PATIENT ||--o{ INSURANCE_CLAIM : submits
        
        PATIENT {
            uuid patient_id PK
            string first_name
            string last_name
            date birth_date
            string ssn_encrypted
            json contact_info
            timestamp created_at
        }
        
        DOCTOR {
            uuid doctor_id PK
            string license_number UK
            string specialization
            json schedule
            boolean is_active
        }
        
        APPOINTMENT {
            uuid appointment_id PK
            uuid patient_id FK
            uuid doctor_id FK
            timestamp scheduled_time
            int duration_minutes
            string status
            text notes
        }
        
        MEDICAL_RECORD {
            uuid record_id PK
            uuid patient_id FK
            uuid appointment_id FK
            text diagnosis
            text treatment_plan
            json vital_signs
            timestamp created_at
        }
    </div>
    
    <p><em>Next, we'll explore API and interface design - the doors and windows through which your system communicates with the world.</em></p>
</body>
</html>
