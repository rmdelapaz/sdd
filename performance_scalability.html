<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Performance and Scalability Considerations</title>
    <link rel="stylesheet" href="/styles/main.css">
    <link rel="icon" href="/favicon.png">
    <script type="module">
      import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
      mermaid.initialize({ startOnLoad: true });
    </script>
</head>
<body>
    <h1>Performance and Scalability Considerations</h1>
    
    <p>Building a system without considering performance is like designing a sports car with a lawnmower engine. It might look great, but it won't get you very far! Let's explore how to build systems that are both fast and can grow with your success.</p>
    
    <h2>The Highway Analogy</h2>
    
    <canvas id="highwayCanvas" width="600" height="400"></canvas>
    
    <script>
    const highwayCanvas = document.getElementById('highwayCanvas');
    const hctx = highwayCanvas.getContext('2d');
    
    // Background
    hctx.fillStyle = '#87CEEB';
    hctx.fillRect(0, 0, 600, 200);
    hctx.fillStyle = '#90EE90';
    hctx.fillRect(0, 200, 600, 200);
    
    // Single lane road (poor scalability)
    hctx.fillStyle = '#696969';
    hctx.fillRect(50, 250, 200, 40);
    hctx.strokeStyle = '#FFD700';
    hctx.lineWidth = 2;
    hctx.setLineDash([20, 10]);
    hctx.beginPath();
    hctx.moveTo(50, 270);
    hctx.lineTo(250, 270);
    hctx.stroke();
    
    // Traffic jam
    for(let i = 0; i < 8; i++) {
        hctx.fillStyle = i % 2 === 0 ? '#FF0000' : '#0000FF';
        hctx.fillRect(60 + i * 20, 260, 15, 20);
    }
    
    // Multi-lane highway (good scalability)
    hctx.setLineDash([]);
    hctx.fillStyle = '#696969';
    hctx.fillRect(350, 220, 200, 100);
    
    // Lane markers
    hctx.strokeStyle = '#FFD700';
    hctx.setLineDash([20, 10]);
    for(let i = 1; i < 4; i++) {
        hctx.beginPath();
        hctx.moveTo(350, 220 + i * 25);
        hctx.lineTo(550, 220 + i * 25);
        hctx.stroke();
    }
    
    // Free flowing traffic
    const lanes = [230, 255, 280, 305];
    const colors = ['#FF0000', '#0000FF', '#00FF00', '#FFD700'];
    for(let lane = 0; lane < 4; lane++) {
        for(let i = 0; i < 3; i++) {
            hctx.fillStyle = colors[lane];
            hctx.fillRect(370 + i * 60, lanes[lane], 15, 20);
        }
    }
    
    // Labels
    hctx.setLineDash([]);
    hctx.fillStyle = '#333';
    hctx.font = '14px Arial';
    hctx.fillText('Single Thread', 120, 350);
    hctx.fillText('= Bottleneck', 125, 370);
    
    hctx.fillText('Parallel Processing', 410, 350);
    hctx.fillText('= High Throughput', 415, 370);
    
    // Performance metrics
    hctx.fillStyle = '#FF0000';
    hctx.font = '12px Arial';
    hctx.fillText('‚ö†Ô∏è 100 req/sec max', 90, 220);
    
    hctx.fillStyle = '#00FF00';
    hctx.fillText('‚úì 10,000 req/sec', 410, 190);
    </script>
    
    <h2>Vertical vs Horizontal Scaling: Growing Up vs Growing Out</h2>
    
    <div class="mermaid">
    graph TB
        subgraph "Vertical Scaling (Scale Up)"
            S1[Small Server<br/>2 CPU, 4GB RAM] --> S2[Medium Server<br/>8 CPU, 16GB RAM]
            S2 --> S3[Large Server<br/>32 CPU, 64GB RAM]
            S3 --> S4[Monster Server<br/>128 CPU, 256GB RAM]
            S4 --> LIMIT1[Hardware Limits!]
        end
        
        subgraph "Horizontal Scaling (Scale Out)"
            H1[Server 1] --> LB[Load Balancer]
            H2[Server 2] --> LB
            H3[Server 3] --> LB
            H4[Server N...] --> LB
            LB --> SCALE[Infinite Scale!]
        end
        
        style S1 fill:#ffccbc
        style S2 fill:#ffab91
        style S3 fill:#ff8a65
        style S4 fill:#ff7043
        style LIMIT1 fill:#ff5252
        
        style H1 fill:#c5e1a5
        style H2 fill:#c5e1a5
        style H3 fill:#c5e1a5
        style H4 fill:#c5e1a5
        style SCALE fill:#4caf50
    </div>
    
    <h2>Performance Metrics: What Gets Measured Gets Managed</h2>
    
    <canvas id="metricsCanvas" width="600" height="350"></canvas>
    
    <script>
    const metricsCanvas = document.getElementById('metricsCanvas');
    const mctx = metricsCanvas.getContext('2d');
    
    // Background
    mctx.fillStyle = '#f5f5f5';
    mctx.fillRect(0, 0, 600, 350);
    
    // Title
    mctx.fillStyle = '#333';
    mctx.font = '16px Arial';
    mctx.fillText('Key Performance Indicators', 200, 30);
    
    // Metric cards
    const metrics = [
        {x: 50, y: 60, title: 'Response Time', value: '< 200ms', color: '#4CAF50', desc: 'Time to first byte'},
        {x: 220, y: 60, title: 'Throughput', value: '1000 RPS', color: '#2196F3', desc: 'Requests per second'},
        {x: 390, y: 60, title: 'Error Rate', value: '< 0.1%', color: '#FF9800', desc: 'Failed requests'},
        {x: 50, y: 190, title: 'CPU Usage', value: '< 70%', color: '#9C27B0', desc: 'Processing power'},
        {x: 220, y: 190, title: 'Memory', value: '< 80%', color: '#E91E63', desc: 'RAM utilization'},
        {x: 390, y: 190, title: 'Uptime', value: '99.9%', color: '#00BCD4', desc: 'Availability'}
    ];
    
    metrics.forEach(metric => {
        // Card background
        mctx.fillStyle = metric.color;
        mctx.fillRect(metric.x, metric.y, 150, 100);
        
        // White content area
        mctx.fillStyle = '#fff';
        mctx.fillRect(metric.x + 5, metric.y + 30, 140, 65);
        
        // Title
        mctx.fillStyle = '#fff';
        mctx.font = '12px Arial';
        mctx.fillText(metric.title, metric.x + 40, metric.y + 20);
        
        // Value
        mctx.fillStyle = metric.color;
        mctx.font = '20px Arial';
        mctx.fillText(metric.value, metric.x + 30, metric.y + 60);
        
        // Description
        mctx.fillStyle = '#666';
        mctx.font = '10px Arial';
        mctx.fillText(metric.desc, metric.x + 35, metric.y + 80);
    });
    
    // Performance equation
    mctx.fillStyle = '#333';
    mctx.font = '14px Arial';
    mctx.fillText('Performance = Speed √ó Reliability √ó Efficiency', 150, 320);
    </script>
    
    <h2>Caching Strategy: The Memory Game</h2>
    
    <div class="mermaid">
    graph LR
        Client[Client Request] --> Cache{Cache Check}
        Cache -->|Hit| CacheData[Return Cached Data<br/>1ms]
        Cache -->|Miss| App[Application Server]
        App --> DB[(Database<br/>50ms)]
        DB --> App
        App --> UpdateCache[Update Cache]
        UpdateCache --> Response[Return to Client]
        
        subgraph "Cache Layers"
            L1[Browser Cache<br/>0ms]
            L2[CDN Cache<br/>10ms]
            L3[Redis Cache<br/>1ms]
            L4[Application Cache<br/>0.1ms]
        end
        
        style CacheData fill:#4caf50
        style Cache fill:#2196f3
        style L1 fill:#e8f5e9
        style L2 fill:#e3f2fd
        style L3 fill:#fff3e0
        style L4 fill:#fce4ec
    </div>
    
    <h2>Real-World Example: Video Streaming Platform</h2>
    
    <div style="background-color: #e3f2fd; padding: 20px; border-radius: 8px; margin: 20px 0;">
        <h3>Scaling Netflix-Style Architecture</h3>
        
        <div class="mermaid">
        graph TB
            subgraph "Edge Layer"
                CDN1[CDN POP 1]
                CDN2[CDN POP 2]
                CDN3[CDN POP N...]
            end
            
            subgraph "API Gateway"
                GW[API Gateway<br/>Rate Limiting]
            end
            
            subgraph "Microservices"
                USER[User Service]
                VIDEO[Video Service]
                REC[Recommendation Service]
                TRANS[Transcoding Service]
            end
            
            subgraph "Data Layer"
                CACHE[(Redis Cluster)]
                DB[(Cassandra)]
                S3[Object Storage]
            end
            
            CDN1 --> GW
            CDN2 --> GW
            CDN3 --> GW
            
            GW --> USER
            GW --> VIDEO
            GW --> REC
            
            USER --> CACHE
            VIDEO --> CACHE
            REC --> DB
            TRANS --> S3
            
            style CDN1 fill:#4caf50
            style CDN2 fill:#4caf50
            style CDN3 fill:#4caf50
            style CACHE fill:#ff9800
        </graph>
        </div>
        
        <h4>Performance Strategies Used:</h4>
        <ul>
            <li>üìç <strong>Edge Caching:</strong> Content served from nearest location</li>
            <li>üîÑ <strong>Adaptive Bitrate:</strong> Quality adjusts to bandwidth</li>
            <li>üìä <strong>Predictive Caching:</strong> Pre-load likely next episodes</li>
            <li>‚ö° <strong>Async Processing:</strong> Transcoding happens in background</li>
        </ul>
    </div>
    
    <h2>Database Optimization: The Art of Speed</h2>
    
    <canvas id="dbOptCanvas" width="600" height="400"></canvas>
    
    <script>
    const dbCanvas = document.getElementById('dbOptCanvas');
    const dctx = dbCanvas.getContext('2d');
    
    // Background
    dctx.fillStyle = '#f9f9f9';
    dctx.fillRect(0, 0, 600, 400);
    
    // Before optimization
    dctx.fillStyle = '#ffcccc';
    dctx.fillRect(50, 50, 220, 300);
    dctx.fillStyle = '#333';
    dctx.font = '14px Arial';
    dctx.fillText('Before Optimization', 110, 30);
    
    // Slow query visual
    dctx.fillStyle = '#d32f2f';
    dctx.fillRect(70, 80, 180, 40);
    dctx.fillStyle = '#fff';
    dctx.font = '11px Arial';
    dctx.fillText('SELECT * FROM users', 100, 100);
    dctx.fillText('WHERE name LIKE "%john%"', 85, 110);
    
    // Performance bar
    dctx.fillStyle = '#ffab91';
    dctx.fillRect(70, 140, 180, 30);
    dctx.fillStyle = '#333';
    dctx.fillText('Full table scan: 5000ms', 100, 160);
    
    // Problems
    dctx.font = '10px Arial';
    dctx.fillText('‚ùå No indexes', 80, 200);
    dctx.fillText('‚ùå SELECT *', 80, 220);
    dctx.fillText('‚ùå Leading wildcard', 80, 240);
    dctx.fillText('‚ùå No query plan', 80, 260);
    
    // After optimization
    dctx.fillStyle = '#ccffcc';
    dctx.fillRect(330, 50, 220, 300);
    dctx.fillStyle = '#333';
    dctx.font = '14px Arial';
    dctx.fillText('After Optimization', 390, 30);
    
    // Optimized query
    dctx.fillStyle = '#4caf50';
    dctx.fillRect(350, 80, 180, 40);
    dctx.fillStyle = '#fff';
    dctx.font = '11px Arial';
    dctx.fillText('SELECT id, name, email', 370, 100);
    dctx.fillText('FROM users WHERE idx_name', 360, 110);
    
    // Performance bar
    dctx.fillStyle = '#81c784';
    dctx.fillRect(350, 140, 180, 30);
    dctx.fillStyle = '#333';
    dctx.fillText('Index scan: 50ms', 395, 160);
    
    // Improvements
    dctx.font = '10px Arial';
    dctx.fillText('‚úì B-tree index on name', 360, 200);
    dctx.fillText('‚úì Specific columns', 360, 220);
    dctx.fillText('‚úì Query optimization', 360, 240);
    dctx.fillText('‚úì Execution plan analyzed', 360, 260);
    
    // Speedup indicator
    dctx.fillStyle = '#2196f3';
    dctx.font = '20px Arial';
    dctx.fillText('100x', 275, 180);
    dctx.fillText('faster!', 270, 205);
    
    // Arrow
    dctx.strokeStyle = '#2196f3';
    dctx.lineWidth = 3;
    dctx.beginPath();
    dctx.moveTo(270, 200);
    dctx.lineTo(330, 200);
    dctx.stroke();
    </script>
    
    <h2>Load Testing: Stress Testing Your System</h2>
    
    <div class="mermaid">
    graph TD
        A[Load Testing Strategy] --> B[Baseline Test]
        A --> C[Stress Test]
        A --> D[Spike Test]
        A --> E[Endurance Test]
        
        B --> B1[Normal load<br/>100 users]
        C --> C1[Breaking point<br/>10,000 users]
        D --> D1[Sudden surge<br/>100 ‚Üí 5000 users]
        E --> E1[Extended period<br/>1000 users/24hrs]
        
        B1 --> M1[Response time?]
        C1 --> M2[Max capacity?]
        D1 --> M3[Recovery time?]
        E1 --> M4[Memory leaks?]
        
        style B fill:#4caf50
        style C fill:#ff9800
        style D fill:#f44336
        style E fill:#2196f3
    </div>
    
    <h2>Performance Budget: Speed as a Feature</h2>
    
    <div style="background-color: #fff3e0; padding: 20px; border-radius: 8px; margin: 20px 0;">
        <h3>Performance Budget Example</h3>
        
        <table style="width: 100%; border-collapse: collapse;">
            <tr style="background-color: #ffb74d;">
                <th style="padding: 10px; border: 1px solid #e65100;">Metric</th>
                <th style="padding: 10px; border: 1px solid #e65100;">Budget</th>
                <th style="padding: 10px; border: 1px solid #e65100;">Current</th>
                <th style="padding: 10px; border: 1px solid #e65100;">Status</th>
            </tr>
            <tr>
                <td style="padding: 10px; border: 1px solid #ddd;">Page Load Time</td>
                <td style="padding: 10px; border: 1px solid #ddd;">< 3s</td>
                <td style="padding: 10px; border: 1px solid #ddd;">2.1s</td>
                <td style="padding: 10px; border: 1px solid #ddd;">‚úÖ Pass</td>
            </tr>
            <tr>
                <td style="padding: 10px; border: 1px solid #ddd;">Time to Interactive</td>
                <td style="padding: 10px; border: 1px solid #ddd;">< 5s</td>
                <td style="padding: 10px; border: 1px solid #ddd;">4.2s</td>
                <td style="padding: 10px; border: 1px solid #ddd;">‚úÖ Pass</td>
            </tr>
            <tr>
                <td style="padding: 10px; border: 1px solid #ddd;">Bundle Size</td>
                <td style="padding: 10px; border: 1px solid #ddd;">< 200KB</td>
                <td style="padding: 10px; border: 1px solid #ddd;">245KB</td>
                <td style="padding: 10px; border: 1px solid #ddd;">‚ùå Fail</td>
            </tr>
            <tr>
                <td style="padding: 10px; border: 1px solid #ddd;">API Response Time</td>
                <td style="padding: 10px; border: 1px solid #ddd;">< 100ms</td>
                <td style="padding: 10px; border: 1px solid #ddd;">87ms</td>
                <td style="padding: 10px; border: 1px solid #ddd;">‚úÖ Pass</td>
            </tr>
        </table>
        
        <p style="margin-top: 15px;"><strong>Action Required:</strong> Reduce JavaScript bundle size by 45KB through code splitting and tree shaking.</p>
    </div>
    
    <h2>Scalability Patterns: Building for Growth</h2>
    
    <canvas id="patternsCanvas" width="600" height="300"></canvas>
    
    <script>
    const patCanvas = document.getElementById('patternsCanvas');
    const pctx = patCanvas.getContext('2d');
    
    // Background
    pctx.fillStyle = '#f5f5f5';
    pctx.fillRect(0, 0, 600, 300);
    
    // Pattern 1: Microservices
    pctx.fillStyle = '#4CAF50';
    pctx.fillRect(30, 50, 80, 60);
    pctx.fillRect(30, 120, 80, 60);
    pctx.fillRect(30, 190, 80, 60);
    pctx.fillStyle = '#fff';
    pctx.font = '10px Arial';
    pctx.fillText('User MS', 50, 85);
    pctx.fillText('Order MS', 48, 155);
    pctx.fillText('Payment MS', 42, 225);
    
    pctx.fillStyle = '#333';
    pctx.font = '12px Arial';
    pctx.fillText('Microservices', 35, 30);
    pctx.font = '10px Arial';
    pctx.fillText('Scale independently', 25, 270);
    
    // Pattern 2: Event-Driven
    pctx.fillStyle = '#2196F3';
    pctx.beginPath();
    pctx.arc(270, 150, 40, 0, 2 * Math.PI);
    pctx.fill();
    pctx.fillStyle = '#fff';
    pctx.font = '10px Arial';
    pctx.fillText('Event Bus', 245, 155);
    
    // Publishers/Subscribers
    for(let i = 0; i < 3; i++) {
        pctx.fillStyle = '#64B5F6';
        pctx.fillRect(180, 60 + i * 70, 50, 30);
        pctx.fillRect(310, 60 + i * 70, 50, 30);
    }
    
    pctx.fillStyle = '#333';
    pctx.font = '12px Arial';
    pctx.fillText('Event-Driven', 235, 30);
    pctx.font = '10px Arial';
    pctx.fillText('Async & decoupled', 230, 270);
    
    // Pattern 3: CQRS
    pctx.fillStyle = '#FF9800';
    pctx.fillRect(420, 60, 150, 80);
    pctx.strokeStyle = '#E65100';
    pctx.lineWidth = 2;
    pctx.beginPath();
    pctx.moveTo(495, 60);
    pctx.lineTo(495, 140);
    pctx.stroke();
    
    pctx.fillStyle = '#fff';
    pctx.font = '10px Arial';
    pctx.fillText('Commands', 435, 100);
    pctx.fillText('Queries', 515, 100);
    
    pctx.fillStyle = '#333';
    pctx.font = '12px Arial';
    pctx.fillText('CQRS Pattern', 460, 30);
    pctx.font = '10px Arial';
    pctx.fillText('Read/Write separation', 440, 270);
    
    // Arrows showing benefits
    pctx.strokeStyle = '#4CAF50';
    pctx.lineWidth = 2;
    pctx.beginPath();
    pctx.moveTo(70, 280);
    pctx.lineTo(270, 280);
    pctx.lineTo(470, 280);
    pctx.stroke();
    
    pctx.fillStyle = '#4CAF50';
    pctx.font = '11px Arial';
    pctx.fillText('Enables horizontal scaling ‚Üí', 220, 295);
    </script>
    
    <h2>The Golden Rules of Performance</h2>
    
    <div style="background-color: #e8f5e9; padding: 20px; border-radius: 8px; margin: 20px 0;">
        <h3>Performance Commandments</h3>
        
        <p>üöÄ <strong>Measure First, Optimize Second:</strong> Don't guess where the bottlenecks are</p>
        <p>üíæ <strong>Cache Everything Reasonable:</strong> But remember cache invalidation is hard</p>
        <p>üìä <strong>Database Queries are Expensive:</strong> Optimize queries, add indexes wisely</p>
        <p>üîÑ <strong>Async When Possible:</strong> Don't block on I/O operations</p>
        <p>üì¶ <strong>Minimize Payload Size:</strong> Compress, paginate, and send only what's needed</p>
        <p>üéØ <strong>Set Performance Budgets:</strong> Make speed a feature, not an afterthought</p>
        <p>üìà <strong>Plan for 10x Growth:</strong> Design systems that can scale beyond current needs</p>
        <p>üîç <strong>Monitor Production:</strong> Real users do unexpected things</p>
        <p>‚ö° <strong>Fail Fast:</strong> Quick timeouts prevent cascade failures</p>
        <p>üîß <strong>Optimize the Critical Path:</strong> Focus on what users experience most</p>
    </div>
    
    <p><em>Next, we'll explore testing strategies and quality assurance - because fast systems that don't work correctly are just very efficient at failing!</em></p>
</body>
</html>
